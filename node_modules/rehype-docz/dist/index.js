"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var path=require("path"),is=_interopDefault(require("unist-util-is")),flatten=_interopDefault(require("lodash.flatten")),nodeToString=_interopDefault(require("hast-util-to-string")),doczUtils=require("docz-utils"),format=require("docz-utils/lib/format"),codesandbox=require("docz-utils/lib/codesandbox");const isPlayground=e=>"Playground"===e,addPropsOnPlayground=async(e,t,o,a,r,i)=>{const s=doczUtils.jsx.componentName(e.value),n=RegExp(`^\\<${s}`);if(isPlayground(s)){const l=(await format.format(nodeToString(e))).slice(1,1/0),d=`{props,${o.join(",")}}`,u=doczUtils.jsx.sanitizeCode(doczUtils.jsx.removeTags(l));if(e.value=e.value.replace(n,`<${s} __position={${t}} __code={\`${u}\`} __scope={${d}}`),i){const t=await codesandbox.getSandboxImportInfo(u,a,r);e.value=e.value.replace(n,`<${s} __codesandbox={\`${t}\`}`)}}},addComponentsProps=(e,t,o,a)=>async(r,i)=>{await addPropsOnPlayground(r,i,e,t,o,a)};var index=(e,t)=>()=>(o,a)=>{const r=o.children.filter(e=>is("import",e)),i=flatten(r.map(doczUtils.imports.getFullImports)),s=flatten(r.map(doczUtils.imports.getImportsVariables)),n=path.relative(e,path.dirname(a.history[0])),l=o.children.filter(e=>is("jsx",e)).map(addComponentsProps(s,i,n,t));return Promise.all(l).then(()=>o)};exports.default=index;
